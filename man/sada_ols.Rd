% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sada_ols.R
\name{sada_ols}
\alias{sada_ols}
\title{SADA estimator for linear regression coefficients}
\usage{
sada_ols(Y, Yhat_labeled, Yhat_unlabeled, X_labeled, X_unlabeled, level = 0.95)
}
\arguments{
\item{Y}{Numeric vector of outcomes for the labeled data.}

\item{Yhat_labeled}{Numeric matrix of predictions for labeled samples.}

\item{Yhat_unlabeled}{Numeric matrix of predictions for unlabeled samples.}

\item{X_labeled}{Covariate matrix for labeled data (no intercept column).}

\item{X_unlabeled}{Covariate matrix for unlabeled data (no intercept column).}

\item{level}{Confidence level (default 0.95).}
}
\value{
An object of class \code{"sada_ols"} which is a list with:
\describe{
\item{est}{Estimated regression coefficients (including intercept).}
\item{sd}{Standard errors of each coefficient.}
\item{ci}{Matrix with two columns \code{lower} and \code{upper}
giving the confidence interval for each coefficient.}
\item{ci_length}{Length of each confidence interval.}
\item{w_opt}{List of optimal SADA weight matrices (one per predictor).}
\item{vcov}{Estimated covariance matrix of the coefficients.}
\item{level}{Confidence level used for the intervals.}
\item{call}{The matched function call.}
}
}
\description{
Implements SADA for the linear model \code{Y ~ X} using labeled and
unlabeled data with multiple black-box outcome predictions. The covariate
matrices \code{X_labeled} and \code{X_unlabeled} should NOT contain an
intercept column; a column of ones is added internally.
}
\details{
The output of \code{sada_ols} behaves similarly to a fitted
\code{\link[stats]{lm}} object, and several S3 methods are provided:

\describe{

\item{\code{summary(fit)}}{
Produces a regression-style summary table with estimates, standard errors,
z-statistics, and p-values. The printed output mirrors the structure of
\code{summary.lm}. Confidence intervals are also included in the
returned object.
}

\item{\code{predict(fit, newdata)}}{
Generates predictions for new covariate values. The argument
\code{newdata} must be a matrix or data frame \emph{without} an intercept
column; a leading column of ones is added automatically. Predictions are
computed as \eqn{X_{\text{new}} \hat\beta_{\text{SADA}}}.
}

\item{\code{vcov(fit)}}{
Returns the estimated covariance matrix of the SADA coefficient
estimator \eqn{\hat\beta_{\text{SADA}}}. The diagonal entries match the
squared standard errors reported in \code{summary(fit)}.
}

\item{\code{fit$w_opt}}{
A list of \eqn{K} matrices containing the optimal SADA weights applied
to each black-box prediction source. Each matrix has dimension
\eqn{p \times p} and corresponds to the contribution of that prediction
to the calibration of \eqn{X^\top Y} and \eqn{X^\top X}. These weights
determine how SADA adaptively borrows information from unlabeled data.
}

}

A typical workflow is:

\enumerate{
\item Fit the SADA estimator: \code{fit <- sada_ols(...)}.
\item Inspect estimated coefficients using \code{summary(fit)}.
\item Extract standard errors or covariance matrix if needed.
\item Use \code{predict(fit, newdata)} for out-of-sample prediction.
\item Examine \code{fit$w_opt} to understand the influence of each
prediction source.
}
}
\examples{
set.seed(123)

## Example: compare SADA OLS with ordinary OLS using labeled data only

## Sample sizes
n <- 80    # labeled
m <- 200   # unlabeled

## True coefficients: intercept and slopes
beta_true <- c(1, 2, -1)

## Covariates for labeled and unlabeled data (without intercept column)
X_labeled <- cbind(rnorm(n), rnorm(n))
X_unlabeled <- cbind(rnorm(m), rnorm(m))

## Labeled outcomes generated from a linear model with noise
linpred_labeled <- beta_true[1] +
  as.numeric(X_labeled \%*\% beta_true[-1])
Y <- linpred_labeled + rnorm(n, sd = 1)

## Build full covariate matrix (labeled + unlabeled)
X_full <- rbind(X_labeled, X_unlabeled)
N <- n + m

## Underlying linear predictor for all data
linpred_full <- beta_true[1] +
  as.numeric(X_full \%*\% beta_true[-1])

## Two black box prediction sources with different noise levels
Yhat1_full <- linpred_full + rnorm(N, sd = 0.5)
Yhat2_full <- linpred_full + rnorm(N, sd = 1.5)

## Split into labeled and unlabeled prediction matrices
Yhat_labeled <- cbind(Yhat1_full[1:n], Yhat2_full[1:n])
Yhat_unlabeled <- cbind(Yhat1_full[(n + 1):N], Yhat2_full[(n + 1):N])

## Fit SADA OLS estimator
## X_labeled and X_unlabeled do not contain an intercept
## A column of ones is added inside sada_ols
fit_sada <- sada_ols(
  Y = Y,
  Yhat_labeled = Yhat_labeled,
  Yhat_unlabeled = Yhat_unlabeled,
  X_labeled = X_labeled,
  X_unlabeled = X_unlabeled
)

## Coefficient estimates from SADA (including intercept)
fit_sada$est

## Standard errors and confidence intervals from SADA
fit_sada$sd
fit_sada$ci

## A regression style summary, similar to summary(lm)
summary(fit_sada)

## Extract the covariance matrix via the vcov method
vcov(fit_sada)

## Compare with ordinary OLS using labeled data only
## We fit lm on the same covariates, without using any unlabeled data
df_labeled <- data.frame(
  Y = Y,
  X1 = X_labeled[, 1],
  X2 = X_labeled[, 2]
)
fit_lm <- lm(Y ~ X1 + X2, data = df_labeled)

## Coefficients from naive OLS based on labeled data
coef(fit_lm)

## Prediction for new covariate values
## newdata must be a matrix or data frame without an intercept column
X_new <- cbind(rnorm(5), rnorm(5))

## SADA predictions
pred_sada <- predict(fit_sada, newdata = X_new)

}
